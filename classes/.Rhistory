y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10, vjust = -2),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = 0.2, y = 12, label = "Some text")
boxST4
boxST2 = boxST + labs(title = "Title",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10, vjust = -2),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.2, y = 12, label = "Some text")
boxST4
boxST2 = boxST + labs(title = "Title",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10, vjust = -2),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11, label = "Some text")
boxST4
boxST2 = boxST + labs(title = "Title",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10, vjust = -2),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11, label = "Outliers are Columbia and Lincoln")
boxST4
boxST2 = boxST + labs(title = "Title",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10, vjust = -2),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11, label = "Outliers are Columbia and Lincoln", size = 7)
boxST4
boxST2 = boxST + labs(title = "Title",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10, vjust = -2),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11, label = "Outliers are Columbia and Lincoln", size = 2)
boxST4
boxST2 = boxST + labs(title = "Title",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10, vjust = -2),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11, label = "Outliers are Columbia and Lincoln", size = 3)
boxST4
boxST2 = boxST + labs(title = "Title",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10, vjust = -2),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11, label = "Outliers are: \nColumbia and Lincoln", size = 3)
boxST4
boxST2 = boxST + labs(title = "Title",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10, vjust = -2),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 12, label = "Outliers are: \nColumbia and Lincoln", size = 3)
boxST4
boxST2 = boxST + labs(title = "Title",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10, vjust = -2),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11.5, label = "Outliers are: \nColumbia and Lincoln", size = 3)
boxST4
boxST2 = boxST + labs(title = "Title",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_blank(),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11.5, label = "Outliers are: \nColumbia and Lincoln", size = 3)
boxST4
boxST2 = boxST + labs(title = "Title",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11.5, label = "Outliers are: \nColumbia and Lincoln", size = 3)
boxST4
boxST2 = boxST + labs(title = "Title",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
theme(axis.title.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11.5, label = "Outliers are: \nColumbia and Lincoln", size = 3)
boxST4
boxST2 = boxST + labs(title = "Two counties have a student-teacher ratio well below the state average",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
theme(axis.title.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11.5, label = "Outliers are: \nColumbia and Lincoln", size = 3)
boxST4
link='https://github.com/EvansDataScience/VisualAnalytics_2_tabularData/raw/master/data/eduwa.rda'
#getting the data TABLE from the file in the cloud:
load(file=url(link))
#number of rows and columns
dim(eduwa) #nrow(eduwa) ncol(eduwa)
names(eduwa)
names(eduwa)
table(eduwa$High.Grade,exclude = 'nothing')
frqTabO=as.data.frame(prop.table(table(eduwa$High.Grade)))
names(frqTabO)=c('grade','pct')
frqTabO
link='https://github.com/EvansDataScience/VisualAnalytics_2_tabularData/raw/master/data/eduwa.rda'
#getting the data TABLE from the file in the cloud:
load(file=url(link))
#number of rows and columns
dim(eduwa) #nrow(eduwa) ncol(eduwa)
names(eduwa)
table(eduwa$High.Grade,exclude = 'nothing')
library(ggplot2)
# boxplots do not use frequency tables
# as.numeric produces turns levels of the factor into numbers
box1 = ggplot(eduwa, aes(y=as.numeric(High.Grade)))
box1 = box1 + geom_boxplot() + coord_flip() # to show it horizontally
box1
# the labels use the original ordinal levels
ordLabels= levels(eduwa$High.Grade)
box2 = box1 + scale_y_continuous(labels=ordLabels,breaks=1:15)
box2
#get positions
# using 'ggplot_build'
pos_q1=     ggplot_build(box2)$data[[1]]$lower
pos_median= ggplot_build(box2)$data[[1]]$middle
pos_q3=     ggplot_build(box2)$data[[1]]$upper
# using
levels(eduwa$High.Grade)[c(pos_q1,pos_median,pos_q3)]
library(summarytools)
freq(eduwa$High.Grade,style = 'rmarkdown')
box3 = box2 + labs(title = "50% of schools in Washington state offer at most 8th grade",
y = "Highest Grade Offered",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
box4 = box3 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10, vjust = -2),
plot.caption = element_text(hjust = 0, vjust = -1))
box4
summary(eduwa$Free.Lunch)
eduwaFL <- eduwa[complete.cases(eduwa$Free.Lunch),]
datahistFL <- hist(eduwa$Free.Lunch)
baseFL = ggplot(eduwaFL, aes(x = Free.Lunch))
histFL = baseFL + geom_histogram(binwidth = 50, boundary = 0, fill = "lightblue", color = "grey50")
histFL = histFL + stat_bin(binwidth = 50, aes(label=..count..),
geom = "text",boundary = 0,vjust=-1, size = 2)
histFL
titleFL2 = "Very few schools in Washington state have more than 500 students \nreceiving free lunch"
histFL2 = histFL + labs(title = titleFL2,
x = "Students Receiving Free Lunch",
y = "Number of Schools",
caption = "Source: US Department of Education")
histFL3 = histFL2 + theme(panel.background = element_rect(fill = "white", colour = "grey50"),
plot.title = element_text(size = 12, face = "bold"),
axis.title = element_text(size = 10),
axis.text = element_text(size = 8),
plot.caption = element_text(hjust = 0),
axis.title.x = element_text(vjust = -1),
axis.title.y = element_text(vjust = 2))
histFL4 = histFL3 + scale_x_continuous(breaks = c(0,250,500,750,1000,1250,1500,1750), limits = c(0,2000)) +
scale_y_continuous(breaks = c(0,100,200,300,400,500,600), limits = c(0,600))
histFL4
# tapply(variable,group,functionToApply)
tapply(eduwa$Student.Teacher.Ratio, eduwa$County, mean)
# strategy 2:
eduwa4=eduwa[complete.cases(eduwa$Student.Teacher.Ratio),]
tapply(eduwa4$Student.Teacher.Ratio,
eduwa4$County,
mean)
# keeping strategy 2:
meanValues=tapply(eduwa4$Student.Teacher.Ratio,
eduwa4$County,
mean)
summary(meanValues)
stratiodf <- as.data.frame(meanValues)
stratiodf$county <- rownames(stratiodf)
rownames(stratiodf) <- NULL
head(stratiodf)
summary(stratiodf$meanValues)
meanST <- mean(stratiodf$meanValues)
meanST
baseST = ggplot(stratiodf, aes(x = meanValues))
histST = baseST + geom_histogram(binwidth = 2, boundary = 0, fill = "white", color = "grey50")
histST = histST + stat_bin(binwidth = 2, aes(label=..count..),
geom = "text",boundary = 0,vjust=-0.5, size = 3)
histST
titleST2 = "Washington state counties have an average student-teacher ratio approximately equal \nto 18 students per teacher"
histST2 = histST + labs(title = titleST2,
x = "Average Student-Teacher Ratio",
y = "Number of Counties",
caption = "Source: US Department of Education")
histST3 = histST2 + theme(panel.background = element_rect(fill = "white", colour = "grey50"),
plot.title = element_text(size = 12, face = "bold"),
axis.title = element_text(size = 10),
axis.text = element_text(size = 8),
plot.caption = element_text(hjust = 0),
axis.title.x = element_text(vjust = -1),
axis.title.y = element_text(vjust = 2))
histST4 = histST3 + scale_x_continuous(breaks = c(10,12,14,16,18,20,22,24), limits = c(10,24)) +
scale_y_continuous(breaks = c(0,5,10,15,20), limits = c(0,20))
histST5 = histST4 + geom_vline(aes(xintercept = mean(stratiodf$meanValues), color="mean"),
size = 1, linetype = "dashed")
histST5
baseSTden <- ggplot(stratiodf, aes(x = meanValues))
denST <- baseSTden + geom_density()
denST
titleden = "Washington state counties have an average student-teacher ratio approximately \nequal to 18 students per teacher"
denST2 = denST + labs(title = titleden,
x = "Average Student-Teacher Ratio",
y = "Number of Counties",
caption = "Source: US Department of Education")
denST3 = denST2 + theme(panel.background = element_rect(fill = "white", colour = "grey50"),
plot.title = element_text(size = 12, face = "bold"),
axis.title = element_text(size = 10),
axis.text = element_text(size = 8),
plot.caption = element_text(hjust = 0, vjust = -2),
axis.title.x = element_text(vjust = -1),
axis.title.y = element_text(vjust = 2))
denST4 = denST3 + scale_x_continuous(breaks = c(8,10,12,14,16,18,20,22,24,26), limits = c(8,26))
denST5 = denST4 + geom_vline(aes(xintercept = mean(stratiodf$meanValues), color="mean"),
size = 1, linetype = "dashed") +
geom_vline(aes(xintercept = median(stratiodf$meanValues), color="median"),
size = 1, linetype = "dashed", show.legend = TRUE)
denST6 = denST5 + theme(legend.title = element_blank()) +
scale_color_manual(labels = c("Mean", "Median"), values = c("blue", "red"))
denST6
boxST = ggplot(stratiodf, aes(y=meanValues, z="Test"))
boxST = boxST + geom_boxplot() + coord_flip() + scale_y_continuous(breaks = c(10,15,20,25),
limits = c(10,25))
boxST
boxST2 = boxST + labs(title = "Two counties have a student-teacher ratio well below the state average",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
theme(axis.title.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11.5, label = "Outliers are: \nColumbia and Lincoln", size = 3)
boxST4
boxST = ggplot(stratiodf, aes(y=meanValues, z="Test"))
boxST = boxST + geom_boxplot() + coord_flip() + scale_y_continuous(breaks = c(10,15,20,25),
limits = c(10,25))
boxST2 = boxST + labs(title = "Two counties have a student-teacher ratio well below the state average",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
theme(axis.title.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11.5, label = "Outliers are: \nColumbia and Lincoln", size = 3)
boxST4
boxST = ggplot(stratiodf, aes(y=meanValues, z="Test"))
boxST = boxST + geom_boxplot() + coord_flip() + scale_y_continuous(breaks = c(10,15,20,25),
limits = c(10,25))
boxST2 = boxST + labs(title = "Two counties have a student-teacher ratio well below the state average",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
theme(axis.title.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11.5, label = "Outliers are: \nColumbia and Lincoln", size = 3)
boxST4
titleST2 = "Washington state counties have an average student-teacher ratio approximately equal \nto 18 students per teacher"
histST2 = histST + labs(title = titleST2,
x = "Average Student-Teacher Ratio",
y = "Number of Counties",
caption = "Source: US Department of Education")
histST3 = histST2 + theme(panel.background = element_rect(fill = "white", colour = "grey50"),
plot.title = element_text(size = 12, face = "bold"),
axis.title = element_text(size = 10),
axis.text = element_text(size = 8),
plot.caption = element_text(hjust = 0),
axis.title.x = element_text(vjust = -1),
axis.title.y = element_text(vjust = 2))
histST4 = histST3 + scale_x_continuous(breaks = c(10,12,14,16,18,20,22,24), limits = c(10,24)) +
scale_y_continuous(breaks = c(0,5,10,15,20), limits = c(0,20))
histST5 = histST4 + geom_vline(aes(xintercept = mean(stratiodf$meanValues), color="mean"),
size = 1, linetype = "dashed")
histST6 = histST5 + theme(legend.title = element_blank()) +
scale_color_manual(labels = c("Mean"), values = c("blue"))
histST6
link='https://github.com/EvansDataScience/VisualAnalytics_2_tabularData/raw/master/data/eduwa.rda'
#getting the data TABLE from the file in the cloud:
load(file=url(link))
#number of rows and columns
dim(eduwa) #nrow(eduwa) ncol(eduwa)
names(eduwa)
table(eduwa$High.Grade,exclude = 'nothing')
library(ggplot2)
# boxplots do not use frequency tables
# as.numeric produces turns levels of the factor into numbers
box1 = ggplot(eduwa, aes(y=as.numeric(High.Grade)))
box1 = box1 + geom_boxplot() + coord_flip() # to show it horizontally
box1
# the labels use the original ordinal levels
ordLabels= levels(eduwa$High.Grade)
box2 = box1 + scale_y_continuous(labels=ordLabels,breaks=1:15)
box2
#get positions
# using 'ggplot_build'
pos_q1=     ggplot_build(box2)$data[[1]]$lower
pos_median= ggplot_build(box2)$data[[1]]$middle
pos_q3=     ggplot_build(box2)$data[[1]]$upper
# using
levels(eduwa$High.Grade)[c(pos_q1,pos_median,pos_q3)]
library(summarytools)
freq(eduwa$High.Grade,style = 'rmarkdown')
box3 = box2 + labs(title = "50% of schools in Washington state offer at most 8th grade",
y = "Highest Grade Offered",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank())
box4 = box3 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10, vjust = -2),
plot.caption = element_text(hjust = 0, vjust = -1))
box4
summary(eduwa$Free.Lunch)
eduwaFL <- eduwa[complete.cases(eduwa$Free.Lunch),]
datahistFL <- hist(eduwa$Free.Lunch)
baseFL = ggplot(eduwaFL, aes(x = Free.Lunch))
histFL = baseFL + geom_histogram(binwidth = 50, boundary = 0, fill = "lightblue", color = "grey50")
histFL = histFL + stat_bin(binwidth = 50, aes(label=..count..),
geom = "text",boundary = 0,vjust=-1, size = 2)
histFL
titleFL2 = "Very few schools in Washington state have more than 500 students \nreceiving free lunch"
histFL2 = histFL + labs(title = titleFL2,
x = "Students Receiving Free Lunch",
y = "Number of Schools",
caption = "Source: US Department of Education")
histFL3 = histFL2 + theme(panel.background = element_rect(fill = "white", colour = "grey50"),
plot.title = element_text(size = 12, face = "bold"),
axis.title = element_text(size = 10),
axis.text = element_text(size = 8),
plot.caption = element_text(hjust = 0),
axis.title.x = element_text(vjust = -1),
axis.title.y = element_text(vjust = 2))
histFL4 = histFL3 + scale_x_continuous(breaks = c(0,250,500,750,1000,1250,1500,1750), limits = c(0,2000)) +
scale_y_continuous(breaks = c(0,100,200,300,400,500,600), limits = c(0,600))
histFL4
# strategy 2:
eduwa4=eduwa[complete.cases(eduwa$Student.Teacher.Ratio),]
tapply(eduwa4$Student.Teacher.Ratio,
eduwa4$County,
mean)
# keeping strategy 2:
meanValues=tapply(eduwa4$Student.Teacher.Ratio,
eduwa4$County,
mean)
summary(meanValues)
stratiodf <- as.data.frame(meanValues)
stratiodf$county <- rownames(stratiodf)
rownames(stratiodf) <- NULL
head(stratiodf)
summary(stratiodf$meanValues)
meanST <- mean(stratiodf$meanValues)
meanST
baseST = ggplot(stratiodf, aes(x = meanValues))
histST = baseST + geom_histogram(binwidth = 2, boundary = 0, fill = "white", color = "grey50")
histST = histST + stat_bin(binwidth = 2, aes(label=..count..),
geom = "text",boundary = 0,vjust=-0.5, size = 3)
histST
titleST2 = "Washington state counties have an average student-teacher ratio approximately equal \nto 18 students per teacher"
histST2 = histST + labs(title = titleST2,
x = "Average Student-Teacher Ratio",
y = "Number of Counties",
caption = "Source: US Department of Education")
histST3 = histST2 + theme(panel.background = element_rect(fill = "white", colour = "grey50"),
plot.title = element_text(size = 12, face = "bold"),
axis.title = element_text(size = 10),
axis.text = element_text(size = 8),
plot.caption = element_text(hjust = 0),
axis.title.x = element_text(vjust = -1),
axis.title.y = element_text(vjust = 2))
histST4 = histST3 + scale_x_continuous(breaks = c(10,12,14,16,18,20,22,24), limits = c(10,24)) +
scale_y_continuous(breaks = c(0,5,10,15,20), limits = c(0,20))
histST5 = histST4 + geom_vline(aes(xintercept = mean(stratiodf$meanValues), color="mean"),
size = 1, linetype = "dashed")
histST6 = histST5 + theme(legend.title = element_blank()) +
scale_color_manual(labels = c("Mean"), values = c("blue"))
histST6
baseSTden <- ggplot(stratiodf, aes(x = meanValues))
denST <- baseSTden + geom_density()
denST
titleden = "Washington state counties have an average student-teacher ratio approximately \nequal to 18 students per teacher"
denST2 = denST + labs(title = titleden,
x = "Average Student-Teacher Ratio",
y = "Number of Counties",
caption = "Source: US Department of Education")
denST3 = denST2 + theme(panel.background = element_rect(fill = "white", colour = "grey50"),
plot.title = element_text(size = 12, face = "bold"),
axis.title = element_text(size = 10),
axis.text = element_text(size = 8),
plot.caption = element_text(hjust = 0, vjust = -2),
axis.title.x = element_text(vjust = -1),
axis.title.y = element_text(vjust = 2))
denST4 = denST3 + scale_x_continuous(breaks = c(8,10,12,14,16,18,20,22,24,26), limits = c(8,26))
denST5 = denST4 + geom_vline(aes(xintercept = mean(stratiodf$meanValues), color="mean"),
size = 1, linetype = "dashed") +
geom_vline(aes(xintercept = median(stratiodf$meanValues), color="median"),
size = 1, linetype = "dashed", show.legend = TRUE)
denST6 = denST5 + theme(legend.title = element_blank()) +
scale_color_manual(labels = c("Mean", "Median"), values = c("blue", "red"))
denST6
boxST = ggplot(stratiodf, aes(y=meanValues, z="Test"))
boxST = boxST + geom_boxplot() + coord_flip() + scale_y_continuous(breaks = c(10,15,20,25),
limits = c(10,25))
boxST2 = boxST + labs(title = "Two counties have a student-teacher ratio well below the state average",
y = "Average Student-Teacher Ratio",
caption = "Source: US Department of Education") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
theme(axis.title.y = element_blank())
boxST3 = boxST2 + theme(plot.title = element_text(size = 12, face = "bold"),
axis.text.x = element_text(size = 8),
axis.title.x = element_text(size = 10),
plot.caption = element_text(hjust = 0, vjust = -1))
boxST4 = boxST3 + annotate("text", x = -0.1, y = 11.5, label = "Outliers are: \nColumbia and Lincoln", size = 3)
boxST4
